#@layout()
#define main()
<div class="layui-tab">
	<ul class="layui-tab-title">
		<li class="layui-this">列表</li>
	</ul>
	<div class="layui-tab-content">
		<div>
            <a href="/user/add" class="layui-btn layui-btn-normal" title="新增"><i class="layui-icon">&#xe608;&nbsp;新增</i></a>
            <a href="/user" class="layui-btn layui-btn-normal" title="刷新"><i class="layui-icon">&#x1002;&nbsp;刷新</i></a>
		</div>
		<div class="layui-tab-item layui-show">
			<table class="layui-hide" id="table-user" lay-filter="user-tool"></table>
		</div>
	</div>
</div>

<script>
	layui.use('table', function(){
		var table = layui.table;
        var $ = layui.jquery;
        //监听工具条
        table.on('tool(user-tool)', function(obj){
            var data = obj.data;
            if(obj.event === 'detail'){
				layer.open({
					type: 2,
					title: '查看用户',
					shadeClose: true,
					shade: 0.6,
					area: ['60%', '80%'],
					content: '/user/show/' + data.id, //iframe的url
					end: function () {}
				})
            } else if(obj.event === 'del'){
                layer.confirm('确定删除？', function(index){
                    //obj.del();
                    //layer.close(index);
                    window.location.href='/user/delete/' + data.id;
                });
            } else if(obj.event === 'edit'){
                window.location.href='/user/edit/' + data.id;
                /*layer.open({
                    title : '修改'
                    ,type: 1
                    ,shade: 0 //不显示遮罩
                    ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                    ,anim  : 1
                    ,yes: function(){
                        layer.closeAll();
                    }
                    ,success: function(layero, index){
                        console.log(layero, index);
                    }
                    ,content: $('#user_update_form') //这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
                    ,area: '600px'
                });*/
                //layer.alert('编辑行：<br>'+ JSON.stringify(data))
            }
        });
		table.render({
			elem: '#table-user'
			,url:'/user/list'
			,cellMinWidth: 60
			,cols: [[
                    {field:'name', title: '姓名'},
                    {field:'sex', title: '性别'},
                    {field:'age', title: '年龄'},
                    {field:'birthday', title: '生日'},
                    {field:'pay', title: '薪资'},
                        {field:'address', title: '地址'},
                        //大文本不显示在列表
                    {field:'', title: '操作',minWidth:160,toolbar: '#user-bar'},
			]]
            ,even: true //开启隔行背景
			,page: true
		});
	});
</script>

<script type="text/html" id="user-bar">
	<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
	<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
	<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
#end